<div class="toolbar">
  <button class="closebutton" (click)="closeWindow()"><mat-icon>close</mat-icon></button>
</div> 
<div class="wrapper">
  <h1>Profile Settings</h1>

  <div class="credentialsForm loginFormWrapper">
    <form name="credentialsForm" [formGroup]="changeForm">
      
      
      
      <div class="form-preview" *ngIf="!changeUsernameEnable && !changeEmailEnable && !changePasswordEnable && !changeLanguageEnable">
          <h2>Username:</h2>
          <p>{{changeName}}</p>
          <button class="btnPreview" (click)="changeUsernamePreview()">Change Username</button>
      </div>
      <div [className]="changeUsernameEnable ? 'fix-mat-form-field' : 'hide fix-mat-form-field'">
        <mat-form-field class="full-with-field" appearance="outline">
          <input matInput placeholder="Username" value = "{{changeName}}" [(ngModel)]="name" [formControl]="nameFormControl">
          <!--<mat-error *ngIf="nameFormControl.invalid">{{getRequiredErrorMessage('name')}}</mat-error>-->
        </mat-form-field>
      </div>

      <div class="form-preview" *ngIf="!changeUsernameEnable && !changeEmailEnable && !changePasswordEnable && !changeLanguageEnable">
          <h2>E-Mail:</h2>
          <p>{{changeEmail}}</p>
          <button class="btnPreview" (click)="changeEmailPreview()">Change E-Mail</button>
      </div>
      <div [className]="changeEmailEnable ? 'fix-mat-form-field' : 'hide fix-mat-form-field'">
        <mat-form-field class="full-with-field" appearance="outline">
          <input matInput placeholder="Email" value = "{{changeEmail}}" [(ngModel)]="email" [formControl]="emailFormControl">
          <!--<mat-error *ngIf="emailFormControl.invalid">{{getRequiredErrorMessage('email')}}</mat-error>-->
        </mat-form-field>
      </div>

      <div class="form-preview" *ngIf="!changeUsernameEnable && !changeEmailEnable && !changePasswordEnable && !changeLanguageEnable">
          <h2>Password:</h2>
          <p>******</p>
          <button class="btnPreview" (click)="changePasswordPreview()">Change Password</button>
      </div>
      <div [className]="changePasswordEnable ? '' : 'hide'">
        <div class="fix-mat-form-field">
          <mat-form-field class="full-with-field" appearance="outline">
            <input matInput placeholder="Old Password" [(ngModel)]="password" [formControl]="passwordFormControl">
            <!--<mat-error *ngIf="passwordFormControl.invalid">{{getRequiredErrorMessage('password')}}</mat-error>-->
          </mat-form-field>
        </div>

        <div class="fix-mat-form-field">
          <mat-form-field class="full-with-field" appearance="outline">
            <input matInput placeholder="New Password" [(ngModel)]="newPassword" [formControl]="newPasswordFormControl">
            <mat-error *ngIf="newPasswordFormControl.invalid">{{getPasswordErrorMessage()}}</mat-error>
          </mat-form-field>
        </div>

        <div class="fix-mat-form-field">
          <mat-form-field class="full-with-field" appearance="outline">
            <input matInput placeholder="Confirm New Password" [(ngModel)]="newConfirmPassword" [formControl]="newConfirmPasswordFormControl">
            <mat-error *ngIf="newConfirmPasswordFormControl.invalid">{{getConfirmPasswordErrorMessage()}}</mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="form-preview" *ngIf="!changeUsernameEnable && !changeEmailEnable && !changePasswordEnable && !changeLanguageEnable">
          <h2>Language:</h2>
          <p *ngIf="languageService.getCurrentLanguageAsString() === 'en'">English</p>
          <p *ngIf="languageService.getCurrentLanguageAsString() === 'de'">Deutsch</p>
          <button class="btnPreview" *ngIf="languageService.getCurrentLanguageAsString() === 'en'" (click)="useLanguage('de')">Change Language</button>
          <button class="btnPreview" *ngIf="languageService.getCurrentLanguageAsString() === 'de'" (click)="useLanguage('en')">Change Language</button>
      </div>
      <div [className]="changeEmailEnable ? 'fix-mat-form-field' : 'hide fix-mat-form-field'">
        <mat-form-field class="full-with-field" appearance="outline">
          <input matInput placeholder="Email" value = "{{changeEmail}}" [(ngModel)]="email" [formControl]="emailFormControl">
          <!--<mat-error *ngIf="emailFormControl.invalid">{{getRequiredErrorMessage('email')}}</mat-error>-->
        </mat-form-field>
      </div>

      <div class="error"><mat-error *ngIf="wrongCredChange">{{getCredChangeErrorMessage()}}</mat-error></div> 
      <div class="error"><mat-error *ngIf="existingCred">{{getCredChangeExistingCred()}}</mat-error></div> 

      <button class="btnSave" [disabled]="changeForm.invalid" (click)="submitCredentialsChange()" *ngIf="changeUsernameEnable || changeEmailEnable || changePasswordEnable">Save Credentials</button>
      <button class="btnCancel" (click)="cancelCredentialsChange()" *ngIf="changeUsernameEnable || changeEmailEnable || changePasswordEnable">Cancel</button>
    </form>
    <button class="btnDelete" (click)="deleteAccountOfUser()" *ngIf="!changeUsernameEnable && !changeEmailEnable && !changePasswordEnable && !changeLanguageEnable">Delete Account</button>
  </div>
</div>
